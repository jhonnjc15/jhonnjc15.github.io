---
import config from "@config/config.json";
import PostHeader from "@components/blog/PostHeader.astro";
import Steps from "@components/blog/Steps.astro";
import LabSections from "@components/blog/LabSections.astro";
import ReviewSections from "@components/blog/ReviewSections.astro";
import categoriesES from "@data/es/blog-categories.json";
import categoriesEN from "@data/en/blog-categories.json";
const { blog_folder } = config.settings;
const { currentLocale } = Astro;

const { post } = Astro.props;
const { Content } = await post.render();
const categoryEntries = currentLocale === "en" ? categoriesEN : categoriesES;
const type = post.data.type;
const steps = post.data.steps ?? [];
const isEnglish = currentLocale === "en";
---

<section class="section blog-single relative overflow-hidden">
  <span class="absolute top-[500px] left-0 w-[360px] h-[220px] bg-gradient-to-tr from-secondary to-green-400 rounded-full blur-3xl opacity-25"></span>
  <span class="absolute top-0 right-8 w-[260px] h-[120px] bg-gradient-to-tr from-secondary to-green-400 rounded-full blur-3xl opacity-25"></span>
  <span class="absolute bottom-0 right-10 w-[240px] h-[180px] bg-gradient-to-tr from-primary to-green-400 rounded-full blur-2xl opacity-25"></span>
  <div class="container relative">
    <PostHeader post={post} categoryEntries={categoryEntries} blogFolder={blog_folder}>
      {
        type === "guide" && (
          <section class="mt-10 space-y-6">
            {post.data.objective && (
              <div class="rounded-2xl border border-border/60 bg-background-offset/40 p-6 space-y-2">
                <p class="text-xs font-semibold uppercase tracking-[0.2em] text-secondary">
                  {isEnglish ? "Objective" : "Objetivo"}
                </p>
                <p class="text-base">{post.data.objective}</p>
              </div>
            )}
            {post.data.materials?.length && (
              <div class="rounded-2xl border border-border/60 bg-background-offset/40 p-6 space-y-3">
                <p class="text-xs font-semibold uppercase tracking-[0.2em] text-secondary">
                  {isEnglish ? "Materials" : "Materiales"}
                </p>
                <ul class="list-disc pl-5 space-y-1">
                  {post.data.materials.map((item: string) => (
                    <li>{item}</li>
                  ))}
                </ul>
              </div>
            )}
            <Steps steps={steps} />
          </section>
        )
      }

      {type === "lab" && (
        <>
          <LabSections lab={post.data} />
          <Steps steps={steps} title={isEnglish ? "Procedure" : "Procedimiento"} />
        </>
      )}

      {type === "review" && <ReviewSections review={post.data} />}

      <div
        class="content prose prose-neutral max-w-none dark:prose-invert prose-a:text-primary dark:prose-a:text-primary mt-12"
        data-animate="fade-up"
      >
        <Content />
      </div>
      <!-- <Disqus client:load /> -->
    </PostHeader>
  </div>
</section>
