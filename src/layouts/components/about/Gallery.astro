---
import { markdownify } from "@lib/utils/textConverter";
const { gallery } = Astro.props;
const { title, description, images } = gallery;

const defaultSizes = ["tall", "wide", "square"];

const galleryItems = images.map((image: any, index: number) => {
  if (typeof image === "string") {
    return {
      src: image,
      alt: title,
      size: defaultSizes[index % defaultSizes.length],
    };
  }

  return {
    ...image,
    size: image.size || defaultSizes[index % defaultSizes.length],
  };
});
---

<section class="section">
  <div class="container">
    <div class="row justify-center text-center">
      <div class="col-10 lg:col-8 space-y-3">
        <p class="text-xs uppercase tracking-[0.25em] text-secondary font-semibold" set:html={markdownify(title)} />
        <h2 class="text-3xl md:text-4xl font-extrabold text-default" set:html={markdownify(title)} />
        {description && (
          <p class="text-text-offset leading-relaxed" set:html={markdownify(description)} />
        )}
      </div>
    </div>

    <div class="relative">
      <div
        class="grid auto-rows-[14px] gap-5 sm:gap-6 md:gap-7 lg:gap-8 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3"
        id="photo-gallery"
      >
        {galleryItems.map((image) => (
          <div
            class={`picture-item group relative overflow-hidden rounded-2xl bg-white/60 shadow-lg shadow-black/5 ring-1 ring-black/10 backdrop-blur`}
            style={{ gridRowEnd: `span ${image.size === "tall" ? 26 : image.size === "wide" ? 18 : 22}` }}
          >
            <div class="relative h-full w-full">
              <img
                class="h-full w-full object-cover transition duration-500 ease-out group-hover:scale-[1.03]"
                src={image.src}
                alt={image.alt || title}
                loading="lazy"
              />
            </div>
          </div>
        ))}
      </div>
    </div>
  </div>
</section>
