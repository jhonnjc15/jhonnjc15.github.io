---
import { Image } from 'astro:assets';
import PageHeader from "@components/PageHeader.astro";
import config from "@config/config.json";
import Base from "@layouts/Base.astro";
import { getEntryBySlug } from "astro:content";
import Form from "@layouts/function-components/Form";
import {
  IoLogoFacebook,
  IoLogoLinkedin,
  IoLogoInstagram,
  IoLogoYoutube,
  IoLogoTiktok,
} from "react-icons/io5/index.js";
import { getEntry } from "astro:content";
import social from "@config/social.json";
import { humanize } from "@lib/utils/textConverter";
import TwitterXLogo from '@components/TwitterXLogo.astro';


const { currentLocale } = Astro
const fallbackLocale = 'es';
let entry = await getEntry("contact", currentLocale);
if (!entry) {
  entry = await getEntry("contact", fallbackLocale);
}

// console.log('entry')
// console.log(entry)

const { title, page_title, form_content_data } = entry.data;
const allowedNetworks = ["facebook", "twitter", "linkedin", "instagram", "youtube", "tiktok"];
const socialIcons = {
  facebook: IoLogoFacebook,
  twitter: TwitterXLogo,
  linkedin: IoLogoLinkedin,
  instagram: IoLogoInstagram,
  youtube: IoLogoYoutube,
  tiktok: IoLogoTiktok,
};
const socialLinks = Object.entries(social).filter(([network, url]) => allowedNetworks.includes(network) && Boolean(url));

const { contact_form_action } = config.params;
const contact = entry.data;
const page_data = {
  ...contact,
  content: contact.body,
};
// console.log('page_data')
// console.log(page_data)


export async function getStaticPaths() {
  return [{ params: { lang: 'es' } }, { params: { lang: 'en' } }]
}

---

<Base
  title={contact.title}
  meta_title={contact.meta_title}
  description={contact.description}
  image={contact.image}
>
  <section class="page-hero pb-4 pt-16" data-animate="fade-up">
    <div class="container">
      <PageHeader page_data={page_data} />
    </div>
  </section>

  <section class="section pb-0" data-animate="zoom-in">
    <div class="container">
      <div class="relative overflow-hidden rounded-[32px] shadow-2xl border border-emerald-200/70 dark:border-emerald-900/60 h-[540px] md:h-[620px]">
        <Image
          src="/images/contact-img.png"
          height={720}
          width={1280}
          quality={95}
          class="absolute inset-0 h-full w-full object-cover [image-rendering:optimizeQuality]"
          alt=""
        />
        <div class="absolute inset-0 bg-gradient-to-br from-primary/40 via-secondary/35 to-emerald-500/35"></div>

        <div class="absolute inset-0 flex items-center">
          <div class="mx-auto max-w-3xl px-6 sm:px-10 lg:px-14 text-white">
            <div class="space-y-3 rounded-2xl bg-primary/25 px-6 py-5 backdrop-blur-md shadow-lg border border-white/10 dark:bg-gray-900/50 dark:border-white/10">
              <p class="text-[0.72rem] uppercase tracking-[0.32em] text-secondary font-semibold drop-shadow">
                {contact.hero_tagline}
              </p>
              <h2 class="text-3xl md:text-4xl font-extrabold leading-tight drop-shadow-lg">{contact.hero_description}</h2>
              <p class="text-white/90 text-base leading-relaxed drop-shadow">{contact.cta_text}</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="section pt-0" data-animate="fade-up">
    <div class="container">
      <div class="relative -mt-36 md:-mt-44 lg:-mt-52">
        <div class="mx-auto max-w-4xl rounded-3xl bg-white dark:bg-gray-900 shadow-2xl border border-gray-200 dark:border-gray-700 px-6 sm:px-8 md:px-10 py-8 sm:py-10">
          <Form
            form_content_data={form_content_data}
            transition:persist client:visible
          />

          <div class="mt-6 border-t border-border/30 dark:border-white/10" aria-hidden="true"></div>

          <div class="mt-6 flex flex-col items-center gap-3">
            <span class="sr-only">Social media</span>
            <div class="flex flex-wrap items-center justify-center gap-3 text-xl text-default">
              {socialLinks.map(([network, url]) => (
                <a
                  href={url}
                  target="_blank"
                  rel="noreferrer"
                  aria-label={humanize(network)}
                  class="inline-flex h-11 w-11 items-center justify-center rounded-full border border-gray-200 bg-white text-default shadow-sm transition hover:border-primary hover:text-primary dark:border-gray-700 dark:bg-gray-800"
                >
                  {(() => {
                    const Icon = socialIcons[network];
                    return Icon ? <Icon /> : null;
                  })()}
                </a>
              ))}
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="section" data-animate="fade-up">
    <div class="container">
      <div class="rounded-3xl bg-gradient-to-r from-primary/10 via-secondary/10 to-primary/10 border border-gray-200 dark:border-gray-700 px-6 sm:px-10 py-10 text-center">
        <h3 class="text-2xl md:text-3xl font-bold text-default">{contact.closing_title}</h3>
        <p class="mt-3 text-text-offset leading-relaxed max-w-3xl mx-auto">{contact.closing_description}</p>
      </div>
    </div>
  </section>

  <section class="section" data-animate="fade-up">
    <div class="container space-y-12">
      <div class="text-center max-w-3xl mx-auto space-y-4">
        <p class="text-xs uppercase tracking-[0.32em] font-semibold text-secondary">Variaciones de layout</p>
        <h3 class="text-3xl font-extrabold text-default">Explora diferentes composiciones para la sección de contacto</h3>
        <p class="text-text-offset leading-relaxed">Elige la disposición que prefieras y elimina el resto del código. Cada ejemplo reutiliza el mismo contenido y formulario para que compares rápidamente.</p>
      </div>

      <!-- Variante 1: Fondo a ancho completo con todo centrado -->
      <article class="relative overflow-hidden rounded-[32px] shadow-2xl border border-white/30 dark:border-white/10">
        <Image
          src="/images/contact_image.jpg"
          height={900}
          width={1600}
          quality={95}
          class="absolute inset-0 h-full w-full object-cover"
          alt=""
        />
        <div class="absolute inset-0 bg-gradient-to-br from-primary/45 via-secondary/35 to-emerald-500/35"></div>
        <div class="relative px-4 py-16 sm:px-8 md:px-12 lg:px-16 text-white">
          <div class="mx-auto max-w-5xl text-center space-y-6">
            <div class="space-y-3">
              <p class="text-[0.75rem] uppercase tracking-[0.32em] font-semibold drop-shadow">{contact.hero_tagline}</p>
              <h3 class="text-3xl md:text-4xl font-bold drop-shadow-lg">{contact.hero_description}</h3>
              <p class="text-white/90 text-base leading-relaxed drop-shadow">{contact.cta_text}</p>
            </div>
            <div class="mx-auto max-w-3xl bg-white/10 backdrop-blur-lg rounded-3xl p-6 sm:p-8 border border-white/20 shadow-2xl">
              <Form
                form_content_data={form_content_data}
                transition:persist client:visible
              />
            </div>
          </div>
        </div>
      </article>

      <!-- Variante 2: Descripción al lado del formulario sobre la misma imagen -->
      <article class="relative overflow-hidden rounded-[32px] shadow-2xl border border-emerald-200/70 dark:border-emerald-900/60">
        <Image
          src="/images/contact-img.png"
          height={720}
          width={1280}
          quality={95}
          class="absolute inset-0 h-full w-full object-cover"
          alt=""
        />
        <div class="absolute inset-0 bg-gradient-to-r from-black/45 via-black/30 to-black/20"></div>

        <div class="relative px-4 py-12 sm:px-8 md:px-12 lg:px-16 text-white">
          <div class="grid gap-10 lg:grid-cols-2 lg:items-center">
            <div class="space-y-4">
              <p class="text-[0.75rem] uppercase tracking-[0.32em] font-semibold text-secondary drop-shadow">{contact.hero_tagline}</p>
              <h3 class="text-3xl md:text-4xl font-bold drop-shadow-lg">{contact.hero_description}</h3>
              <p class="text-white/90 leading-relaxed drop-shadow">{contact.cta_text}</p>
              <div class="flex flex-wrap gap-2">
                {socialLinks.map(([network, url]) => (
                  <a
                    class="inline-flex h-10 w-10 items-center justify-center rounded-full bg-white/15 text-white border border-white/25 hover:bg-white/25 transition"
                    href={url}
                    target="_blank"
                    rel="noreferrer"
                    aria-label={humanize(network)}
                  >
                    {(() => {
                      const Icon = socialIcons[network];
                      return Icon ? <Icon /> : null;
                    })()}
                  </a>
                ))}
              </div>
            </div>

            <div class="bg-white/15 backdrop-blur-xl rounded-3xl p-6 sm:p-8 border border-white/25 shadow-2xl">
              <Form
                form_content_data={form_content_data}
                transition:persist client:visible
              />
            </div>
          </div>
        </div>
      </article>

      <!-- Variante 3: Descripción arriba y formulario debajo en tarjeta clara -->
      <article class="relative overflow-hidden rounded-[32px] border border-gray-200 dark:border-gray-700 bg-gradient-to-br from-white via-white to-primary/5 dark:from-gray-900 dark:via-gray-900 dark:to-primary/10 shadow-2xl">
        <div class="relative px-4 py-12 sm:px-8 md:px-12 lg:px-16">
          <div class="mx-auto max-w-4xl space-y-6 text-center">
            <p class="text-xs uppercase tracking-[0.32em] font-semibold text-secondary">{contact.hero_tagline}</p>
            <h3 class="text-3xl md:text-4xl font-bold text-default">{contact.hero_description}</h3>
            <p class="text-text-offset leading-relaxed max-w-3xl mx-auto">{contact.cta_text}</p>
          </div>

          <div class="mx-auto mt-8 max-w-3xl rounded-3xl bg-white dark:bg-gray-900 shadow-xl border border-gray-200 dark:border-gray-700 px-6 sm:px-8 md:px-10 py-8 sm:py-10">
            <Form
              form_content_data={form_content_data}
              transition:persist client:visible
            />
          </div>
        </div>
      </article>

      <!-- Variante 4: Fondo con filtro verdoso y formulario flotante -->
      <article class="relative overflow-hidden rounded-[32px] shadow-2xl border border-emerald-200/70 dark:border-emerald-900/60">
        <Image
          src="/images/home-background.jpg"
          height={900}
          width={1600}
          quality={95}
          class="absolute inset-0 h-full w-full object-cover"
          alt=""
        />
        <div class="absolute inset-0 bg-emerald-600/35 mix-blend-multiply"></div>
        <div class="absolute inset-0 bg-gradient-to-br from-emerald-400/25 via-primary/20 to-secondary/30"></div>

        <div class="relative px-4 py-14 sm:px-8 md:px-12 lg:px-16 text-white">
          <div class="grid gap-10 lg:grid-cols-[1.1fr_0.9fr] lg:items-center">
            <div class="space-y-4">
              <p class="text-[0.75rem] uppercase tracking-[0.32em] font-semibold text-secondary drop-shadow">Filtro verdoso</p>
              <h3 class="text-3xl md:text-4xl font-bold drop-shadow-lg">{contact.hero_description}</h3>
              <p class="text-white/90 leading-relaxed drop-shadow">{contact.cta_text}</p>
              <div class="flex flex-wrap gap-3 text-white/90">
                <span class="inline-flex items-center gap-2 rounded-full bg-white/15 px-3 py-1 text-sm border border-white/20">{humanize(contact.hero_tagline)}</span>
                <span class="inline-flex items-center gap-2 rounded-full bg-white/15 px-3 py-1 text-sm border border-white/20">Filtro verde</span>
              </div>
            </div>

            <div class="rounded-3xl bg-white/85 text-default shadow-2xl border border-white/60 backdrop-blur-xl px-6 sm:px-8 md:px-10 py-8 sm:py-10">
              <Form
                form_content_data={form_content_data}
                transition:persist client:visible
              />
            </div>
          </div>
        </div>
      </article>
    </div>
  </section>
</Base>
